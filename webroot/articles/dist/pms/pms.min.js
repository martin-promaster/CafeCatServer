/*!
 * OSMP v0.2.0-rc (http://osmp.com.cn)
 * Copyright 2022-2023 Martin Dong <http://osmp.com.cn>
 * Licensed under MIT (https://github.com/ColorlibHQ/AdminLTE/blob/master/LICENSE)
 */
!function(e,a){"object"==typeof exports&&"undefined"!=typeof module?a(exports,require("jquery")):"function"==typeof define&&define.amd?define(["exports","jquery"],a):a((e="undefined"!=typeof globalThis?globalThis:e||self).osmp={},e.jQuery)}(this,(function(e,a){"use strict";var t="OsmpLib",n=a.fn[t],r=function(){function e(e){this.baseData={dataDictionary:[],projectBaseInformation:[],allUsers:[],allDepts:[],allCusts:[],onlineUser:{}},this._init(e)}var t=e.prototype;return t.getBaseData=function(){return this.baseData},t.utmpXAcessToken=function(){var e;return this._get("/api/v1/pub/utmp/token",{},(function(a){e=a.data})),e},t.renderSidebar=function(){a("<div></div>",{class:"image"}).append(a("<img />",{src:"../dist/img/default_id.png",class:"img-circle elevation-2",alt:"User Image"})).appendTo(a(".user-panel")),a("<div></div>",{class:"info"}).append(a("<a></a>",{class:"d-block",href:"#"}).append("Hi, "+this.baseData.onlineUser.userName)).appendTo(a(".user-panel"));var e=a('<span><strong>Copyright &copy; 2021-2024 <a href="http://osmp.com.cn">OSMP.COM.CN</a></strong>&nbsp;&nbsp;All rights reserved.</span>'),t=a("<div />",{class:"float-right d-none d-sm-inline-block"}).html("<b>Version</b>3.1.0");a(".main-footer").children().remove(),a(".main-footer").append(e).append(t)},t._init=function(e){var a;e.department&&(this._get("/api/v1/sm/department/list",{},(function(e){a=e.data})),this.baseData.allDepts=a),e.user&&(this._get("/api/v1/sm/user/mapping/all",{},(function(e){a=e.data})),this.baseData.allUsers=a),e.customer&&(this._get("/api/v1/customer/list",{},(function(e){a=e.data})),this.baseData.allCusts=a),e.dd&&(this._get("/api/v1/sm/dd/-1",{},(function(e){a=e.data})),this.baseData.dataDictionary=a),e.projectBaseInformation&&(this._get("/api/v1/pm/projectBaseInformation/qry/-1",{},(function(e){a=e.data})),this.baseData.projectBaseInformation=a),this.baseData.onlineUser=this._getOnlineUser(),osmpTempKVPairs().set("historyUrl",top.location.href)},t._get=function(e,t,n,r){a.ajax({async:!1,url:e,type:"GET",beforeSend:function(e){e.setRequestHeader("If-Modified-Since","0"),e.setRequestHeader("Cache-Control","no-cache")},contentType:"application/json;charset=UTF-8",dataType:"json",data:t,success:function(e,a,t){"function"==typeof n&&n(e)},error:function(e,a,t){"function"==typeof r&&r()}})},e.post=function(e,t,n,r){a.ajax({async:!1,url:e,type:"POST",beforeSend:function(e){e.setRequestHeader("If-Modified-Since","0"),e.setRequestHeader("Cache-Control","no-cache")},contentType:"application/json;charset=UTF-8",dataType:"json",data:t,success:function(e,a,t){"function"==typeof n&&n(e)},error:function(e,a,t){"function"==typeof r&&r()}})},t._getOnlineUser=function(){var e;return this._get("/api/v1/pub/user/online",{},(function(a){null!=a.errorCode&&(top.location.href="/pages/index.html"),e=a.data}),(function(e,a,t){top.location.href="/pages/index.html"})),e},t._randomRGBStr=function(){return"rgb("+Math.floor(255*Math.random()%255)+","+Math.floor(255*Math.random()%255)+","+Math.floor(255*Math.random()%255)+")"},t._randomRGBAStr=function(e){var a=this._randomRGBStr();return"rgba"+a.substring(3,a.length-1)+","+e+")"},e._jQueryInterface=function(){var a=top.location.pathname.split("/"),t=a[a.length-1],n={department:!0,user:!0,customer:!0,dd:!0,projectBaseInformation:!0};return t.length<1||"/"==t||"index.html"==t?null:["myWorkspace.html","dashboard.html","calendar.html"].indexOf(t)>=0?(n.department=!1,n.user=!0,n.customer=!1,n.dd=!1,n.projectBaseInformation=!1,new e(n)):new e(n)},e}();a(window).on("load",(function(){window.osmpLib=r._jQueryInterface.call(),osmpLib&&osmpLib.renderSidebar()})),a.fn[t]=r._jQueryInterface,a.fn[t].Constructor=r,a.fn[t].noConflict=function(){return a.fn[t]=n,r._jQueryInterface};var o="OsmpSidebar",s=a.fn[o],i=function(){function e(e){this.sidebaMenuItems=[{pageName:"My Workspace",pageUrl:"myWorkspace.html",subMenuItems:[]},{pageName:"Dashboard",pageUrl:"dashboard.html",subMenuItems:[]},{pageName:"Calendar",pageUrl:"calendar.html",subMenuItems:[]},{pageName:"客户管理",pageUrl:"#",subMenuItems:[{href:"custRelationshipMgr.html",name:"客户关系管理"}]},{pageName:"项目管理",pageUrl:"#",subMenuItems:[{href:"pmmProjectMgr.html",name:"项目基本信息"},{href:"pmmTaskBoard.html",name:"项目任务看板"},{href:"pmmProjectTimesheet.html",name:"项目工时管理"}]},{pageName:"人员管理",pageUrl:"#",subMenuItems:[{href:"osmOnsiteStaffMgr.html",name:"驻场人员基本信息"}]},{pageName:"招聘管理",pageUrl:"#",subMenuItems:[{href:"rcmDailyReport.html",name:"招聘进展日报"},{href:"rcmProjectReport.html",name:"招聘项目报告"},{href:"rcmCandidateMgr.html",name:"人才信息库"}]},{pageName:"工具和设置",pageUrl:"#",subMenuItems:[{href:"cfgStaffDailyReport.html",name:"日报提取工具"}]},{pageName:"系统管理",pageUrl:"#",subMenuItems:[{href:"sysUser.html",name:"用户管理"},{href:"sysDepartment.html",name:"部门管理"},{href:"sysRole.html",name:"权限管理"},{href:"sysBaseData.html",name:"基础数据"},{href:"sysParameter.html",name:"系统参数"},{href:"cfgUserSecurity.html",name:"个人设置"}]}],this._initSidebar()}var t=e.prototype;return t.activeItem=function(e){if(["pmm","osm","rem","rcm","sys","cfg","cus"].indexOf(e.substring(0,3))>-1){var t=a('[href="'+e+'"]');t.addClass("active");var n=t.parent().parent();n.css("display","block"),n.parent().addClass("menu-open"),n.parent().children("a").addClass("active")}else a("[href='"+e+"']").addClass("active");"true"==localStorage.getItem("osmp.lte.pushmenu.collapse")?(a("body").removeClass("sidebar-open"),a("body").addClass("sidebar-collapse")):(a("body").removeClass("sidebar-collapse"),a("body").addClass("sidebar-open")),a("body").addClass("layout-fixed text-sm")},t._initSidebar=function(){var e=this;a(".brand-text").html("OSMP");var t=a("<ul />",{class:"nav nav-pills nav-sidebar flex-column nav-compact",role:"menu","data-widget":"treeview","data-accordion":"false"});a(".mt-2").append(t),this.sidebaMenuItems.forEach((function(a){e._addMutipleSidebarMenuItem(t,a.pageName,a.pageUrl,a.subMenuItems)}))},t._addMutipleSidebarMenuItem=function(e,t,n,r){if("#"!=n){var o=a("<li />",{class:"nav-item"});(s=a("<a />",{class:"nav-link ",href:n})).append('<i class="nav-icon fas fa-circle text-info"></i>'),s.append("<p>"+t+"</p>"),o.append(s),e.append(o)}else{var s,i=a("<li />",{class:"nav-item"});(s=a("<a />",{href:"#",class:"nav-link"})).append('<i class="nav-icon fas fa-plus-square"></i>'),s.append("<p>"+t+'<i class="right fas fa-angle-left"></i></p>'),i.append(s);var l=a("<ul />",{class:"nav nav-treeview"});r.forEach((function(e){var t=a("<li />",{class:"nav-item"}),n=a("<a />",{href:e.href,class:"nav-link"});n.append('<i class="far fa-circle nav-icon"></i>'),n.append("<p>"+e.name+"</p>"),t.append(n),l.append(t)})),i.append(l),e.append(i)}},e._jQueryInterface=function(a){var t=new e,n=top.location.pathname.split("/");t.activeItem(n[n.length-1])},e}();i._jQueryInterface.call(),a.fn[o]=i._jQueryInterface,a.fn[o].Constructor=i,a.fn[o].noConflict=function(){return a.fn[o]=s,i._jQueryInterface};var l="OsmpDataTable",p=a.fn[l],d={aLengthMenu:[5,10,30],bFilter:!0,destroy:!0,processing:!0,responsive:!0,lengthChange:!0,autoWidth:!1,serverSide:!0,ajax:{async:!1,url:null,contentType:"application/json",data:null},columns:null,createdRow:null,callbackReg:null,scrollX:!0,hasFooter:!1},c=function(){function e(e,t,n,r,o){if(this._me=null,null==e)throw new Error('OsmpDataTable: Html tag should be binding to. e.g. <div id="pms-data-table"></div>.');if(null==r)throw new Error("OsmpDataTable: Columns should be defined.");if(null==t||null==n)throw new Error("OsmpDataTable: Ajax url and data cannot be null.");this._wrapper=e,this._inner=e+"_"+(new Date).valueOf(),o.bExported&&(o.dom="B<lf<t>ip>",o.buttons=["csv","excel"]),r.push({data:null,colName:"Operation"}),this._option=a.extend({},d,o,{ajax:{url:t,data:n,contentType:"application/json",async:!1},columns:r}),a(this._wrapper).children().remove();var s=a("<table></table>",{id:this._inner.substring(1),class:"table table-bordered table-striped"}),i=a("<tr></tr>"),l=a("<tr></tr>");r.forEach((function(e){var t=null==e.colName?e.data:null==e.colName?"Not defined":e.colName;a("<th>"+t+"</th>").appendTo(i),a("<th>"+t+"</th>").appendTo(l)})),a("<thead></thead>").append(i).appendTo(s),a("<tbody></tbody>").appendTo(s),this._option.hasFooter&&a("<tfoot></tfoot>").append(l).appendTo(s),a(this._wrapper).append(s);var p={};p.fnDefaultRenderRow=this.fnDefaultRenderRow,p.fnAppendOperationButton=this.fnAppendOperationButton,p.createdRow=o.createdRow,p.fnOperationButtonHandler=o.fnOperationButtonHandler,this.fnCallbackChain(p),a(this._inner).DataTable(this._option)}var t=e.prototype;return t.fnAppendOperationButton=function(e,t,n,r){var o=a("<button />",{type:"button",class:"btn btn-sm btn-info","data-toggle":"modal","data-target":"#modal-default","data-v":JSON.stringify(t)}).append('<i class="fa fa-edit">');o.on("click",(function(){r(a(this).data("v"))}));var s=a("<div />",{class:"btn-group"});s.append(o),a("td",e).eq(-1).html("").append(s)},t.fnDefaultRenderRow=function(e,a,t){},t.fnCallbackChain=function(e){"function"==typeof e.createdRow?this._option.createdRow=function(a,t,n){e.createdRow.call(this,a,t,n),e.fnDefaultRenderRow.call(this,a,t,n),e.fnAppendOperationButton.call(this,a,t,n,e.fnOperationButtonHandler)}:this._option.createdRow=function(a,t,n){e.fnDefaultRenderRow.call(this,a,t,n),e.fnAppendOperationButton.call(this,a,t,n,e.fnOperationButtonHandler)},a(this._inner).dataTable().fnAdjustColumnSizing()},t.fnGetRowData=function(e){this._me=a(this._inner).dataTable();var t=this._me.fnGetNodes();return this._me.fnGetData(t[e])},t.fnIsNumber=function(e){return Number.isNaN(Number.parseFloat(e))},e._jQueryInterface=function(){return new e},e}();window.OsmpDataTable=c,a.fn[l]=c._jQueryInterface,a.fn[l].Constructor=c,a.fn[l].noConflict=function(){return a.fn[l]=p,c._jQueryInterface},e.OsmpDataTable=c,e.OsmpLib=r,e.OsmpSidebar=i}));
//# sourceMappingURL=pms.min.js.map