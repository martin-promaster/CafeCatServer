const REG_EXP_DATE="(([0-9]{3}[1-9]|[0-9]{2}[1-9][0-9]{1}|[0-9]{1}[1-9][0-9]{2}|[1-9][0-9]{3})-(((0[13578]|1[02])-(0[1-9]|[12][0-9]|3[01]))|((0[469]|11)-(0[1-9]|[12][0-9]|30))|(02-(0[1-9]|[1][0-9]|2[0-8]))))|((([0-9]{2})(0[48]|[2468][048]|[13579][26])|((0[48]|[2468][048]|[3579][26])00))-02-29)$",SECONDS_OF_DAY=864e5;function pmsPost(e,t,a){$.ajax({async:!1,url:e,type:"POST",contentType:"application/json;charset=UTF-8",dataType:"json",data:JSON.stringify(t),success:function(e,t,n){"function"==typeof a&&a(e)},error:function(e,t,a){console.log(a)}})}function pmsGet(e,t,a,n,i){$.ajax({async:!!t.async,url:e,type:"GET",contentType:"application/json;charset=UTF-8",dataType:"json",data:t,beforeSend:function(e){e.setRequestHeader("If-Modified-Since","0"),e.setRequestHeader("Cache-Control","no-cache"),"function"==typeof i&&i(e)},success:function(e,t,n){"function"==typeof a&&a(e)},error:function(e,t,a){"function"==typeof n&&n()}})}function formatMoney(e){return formatToDottedDecimal(e,2)}function formatToDottedDecimal(e,a){a=a<0?0:a,s=e,s=parseFloat((s+"").replace(/[^\d\.-]/g,"")).toFixed(a)+"";var n=s.split(".")[0].split("").reverse(),o=s.split(".")[1];for(t="",i=0;i<n.length;i++)t+=n[i]+((i+1)%3==0&&i+1!=n.length?",":"");return 0==a?t.split("").reverse().join(""):t.split("").reverse().join("")+"."+o}function formatPercent(e,t){var a=Math.pow(10,t);return Math.round(e*a)/a}function logout(){$.getJSON("/logout?rand="+Math.random(),(function(e){"success"==e.result?parent.location.href="/dashboard":alert("logout failure!")}))}function osmpLoadingBox(){return{show:function(e){this.loadingBoxId=e+(new Date).valueOf();var t='<div id="'+this.loadingBoxId+'" style="text-align: center; z-index: 9999;"><span class="text-center">Loading...</span><i class="fa fa-spinner fa-spin fa-3x fa-fw"></i></div>';$("#"+e).append($(t))},hide:function(){$(this.loadingBoxId).remove()}}}function osmpTempKVPairs(){return{set:function(e,t){localStorage.setItem(e,t)},get:function(e){return localStorage.getItem(e)}}}function getDepartmentNameById(e){var t;return osmpLib.getBaseData().allDepts.forEach((a=>{a.deptUid==e&&(t=a.deptName)})),t}function getOnlineUserCode(){return osmpLib.getBaseData().onlineUser.userCode}function getUserNameByUserCode(e){var t;try{osmpLib.getBaseData().allUsers.forEach((a=>{if(a.userCode==e)throw t=a,new Error("E_MATCHED")}))}catch(e){if("E_MATCHED"!=e.message)throw e}return t.userName}function getValueFromDataDictionaryById(e){var t=parseDataDictionary(e);return t?$("<span></span>",{class:t.remark}).append(t.value):null}function parseDataDictionary(e){var t;try{osmpLib.getBaseData().dataDictionary.forEach((a=>{if(a.id==e)throw t=a,new Error("E_MATCHED")}))}catch(e){if("E_MATCHED"!=e.message)throw e}return t}function getProjectBaseInformationById(e){var t=osmpLib.getBaseData().projectBaseInformation;for(let a=0;a<t.length;a++){const n=t[a];if(n.id==e)return $("<span></span>").append(n.name)}}function getCustName(e){let t;return osmpLib.getBaseData().allCusts.forEach((a=>{e!=a.id||(t=a.name)})),t}function initSelect2Option(e,t){e.empty(),e.select2({ajax:{url:t,dataType:"json"}})}function updateSelect2Option(e,t,a){var n,i;pmsGet(t,{},(e=>{n=e.results})),n.forEach((e=>{e.id==a&&(i=e)})),e.empty(),e.select2({data:[i]}),e.select2({ajax:{url:t,dataType:"json"}})}function addTimelineMessage(e,t,a,n,i){$timeLabel=$("<div></div>",{class:"time-label"}),$timeSection=$("<span></span>",{class:"bg-teal"}),$timeSection.append(t),$timeLabel.append($timeSection),$timeItem=$("<div></div>"),$timeItem.append('<i class="fas fa-envelope bg-blue"></i>'),$timelineItem=$("<div></div>",{class:"timeline-item"}),$timelineItemHeader=$("<h3></h3>",{class:"timeline-header"}),$timelineItemHeader.append(a),$timelineItemBody=$("<div></div>",{class:"timeline-body"}),$timelineItemBody.append(n),$timelineItemFooter=$("<div></div>",{class:"timeline-footer"}),$timelineItemFooter.append(i),$timelineItem.append($timelineItemHeader),$timelineItem.append($timelineItemBody),$timelineItem.append($timelineItemFooter),$timeItem.append($timelineItem),e.append($timeLabel),e.append($timeItem)}function addProgressBar(e,t){var a=$(e.target);t||(t=1),a.css("margin-bottom",t+"rem"),a.html("");var n=formatPercent(e.progress/e.goal*100,2);a.append(e.title+" ("+n+"%)"),$("<span />",{class:"float-right"}).append("<b>"+formatToDottedDecimal(e.progress,0)+"</b>/"+formatToDottedDecimal(e.goal,0)).appendTo(a),$("<div></div>",{class:"progress progress-sm"}).append($("<div></div>",{class:"progress-bar "+e.background,style:"width: "+n+"%"})).appendTo(a)}function createDataTableOpButton(e,t,a,n){var i=$("<button></button>",{type:"button",class:"btn btn-sm "+a,"data-toggle":"modal","data-target":e,onclick:t});return i.append('<i class="'+n+'"></i>'),i}Date.prototype.subDays=function(e){return new Date(this.getTime()-864e5*e)},Date.prototype.plusDays=function(e){return new Date(this.getTime()+864e5*e)},Date.prototype.previousMonth=function(){let e=new Date(this.getTime()),t=e.getMonth()-1<0?12:e.getMonth(),a=11==t?e.getFullYear()-1:e.getFullYear(),n=new Date(a+"-"+t+"-"+e.getDate());return n.getMonth()==e.getMonth()?n.subDays(1):n},Date.prototype.format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var a in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substring(4-RegExp.$1.length))),t)new RegExp("("+a+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[a]:("00"+t[a]).substring((""+t[a]).length)));return e};